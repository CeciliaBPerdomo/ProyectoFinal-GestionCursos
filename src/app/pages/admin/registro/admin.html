<div class="container mt-5">
  <h2 class="mb-2 text-center text-md-start">Alta de Usuario</h2>
  <p class="mb-4 text-center text-md-start text-muted">
    Formulario para registrar un nuevo usuario en el sistema.
  </p>

  <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()" class="row g-4 bg-white p-4 mt-2">

    <!-- Nombre -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Nombre</mat-label>
        <input matInput placeholder="Nombre completo" formControlName="nombre" />
        <mat-error *ngIf="usuarioForm.get('nombre')?.invalid && usuarioForm.get('nombre')?.touched">
          El nombre es obligatorio
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Email -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Email</mat-label>
        <input matInput type="email" placeholder="Correo electrónico" formControlName="email" />
        <mat-error *ngIf="usuarioForm.get('email')?.invalid && usuarioForm.get('email')?.touched">
          Ingrese un email válido
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Password -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Password</mat-label>
        <input matInput type="password" placeholder="Contraseña" formControlName="password" />
        <mat-error *ngIf="usuarioForm.get('password')?.invalid && usuarioForm.get('password')?.touched">
          La contraseña es obligatoria
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Dirección -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Dirección</mat-label>
        <input matInput placeholder="Dirección" formControlName="direccion" />
      </mat-form-field>
    </div>

    <!-- Teléfono -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Teléfono</mat-label>
        <input matInput placeholder="Teléfono" formControlName="telefono" />
      </mat-form-field>
    </div>

    <!-- Perfil -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Perfil</mat-label>
        <mat-select formControlName="perfil">
          <mat-option value="Desarrollador Web">Desarrollador Web</mat-option>
          <mat-option value="Desarrollador IT">Desarrollador IT</mat-option>
          <mat-option value="UX/UI">UX/UI</mat-option>
          <mat-option value="FrontEnd">FrontEnd</mat-option>
          <mat-option value="Backend">Backend</mat-option>
          <mat-option value="FullStack">FullStack</mat-option>
          <mat-option value="DevOps">DevOps</mat-option>
          <mat-option value="QA">QA</mat-option>
          <mat-option value="Usuario Final">Usuario Final</mat-option>
          <mat-option value="Administrador">Administrador</mat-option>
        </mat-select>
        <mat-error *ngIf="usuarioForm.get('perfil')?.invalid && usuarioForm.get('perfil')?.touched">
          Seleccione un perfil
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Rol -->
    <div class="col-12 col-md-6">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Rol</mat-label>
        <mat-select formControlName="rol">
          <mat-option value="alumno">Alumno</mat-option>
          <mat-option value="profesor">Profesor</mat-option>
          <mat-option value="administrador">Administrador</mat-option>
        </mat-select>
        <mat-error *ngIf="usuarioForm.get('rol')?.invalid && usuarioForm.get('rol')?.touched">
          Seleccione un rol
        </mat-error>
      </mat-form-field>
    </div>

    <!-- Botón -->
    <div class="col-12 text-center text-md-end">
      <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        [disabled]="usuarioForm.invalid || (loading$ | async)"
      >
        {{ (loading$ | async) ? 'Guardando...' : 'Guardar Usuario' }}
      </button>
    </div>

  </form>

  <!-- Mensaje de feedback -->
  <div class="mt-3 text-center" *ngIf="mensaje">
    <span [ngClass]="{'text-success': mensaje.startsWith('✅'), 'text-danger': mensaje.startsWith('❌')}">
      {{ mensaje }}
    </span>
  </div>
</div>